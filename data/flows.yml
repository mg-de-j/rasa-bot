flows:
  greet_user:
    description: user says hello or starts a conversation
    steps:
      - action: utter_welcome
      - collect: activity

  introduce_self:
    description: user provides their name or introduces themselves
    steps:
      - collect: user_name
      - action: utter_nice_to_meet

  goodbye_user:
    description: user says goodbye or wants to end the conversation
    steps:
      - action: utter_goodbye

  quiz_flow:
    description: Quiz with at max 15 questions. It stops if the user has 6 questions correct or the 15 questions have been asked.
    steps:
      - action: utter_start_quiz
      
      - collect: question_1
      - collect: question_2
      - collect: question_3
      - collect: question_4
      - collect: question_5 
      - collect: question_6
      - collect: question_7
      - collect: question_8
      - collect: question_9
      - collect: question_10
      
      - action: action_calculate_quiz_score
        next:
          - if: slots.quiz_score < 6
            then:
              - collect: question_11
              - action: action_calculate_quiz_score
                next:
                  - if: slots.quiz_score < 6
                    then:
                      - collect: question_12
                      - action: action_calculate_quiz_score
                        next:
                          - if: slots.quiz_score < 6
                            then:
                              - collect: question_13
                              - action: action_calculate_quiz_score
                                next:
                                  - if: slots.quiz_score < 6
                                    then:
                                      - collect: question_14
                                      - action: action_calculate_quiz_score
                                        next:
                                          - if: slots.quiz_score < 6
                                            then:
                                              - collect: question_15
                                              - action: action_calculate_quiz_score
                                                next:
                                                  - if: slots.quiz_score < 6
                                                    then:
                                                      - action: utter_no_more_questions
                                                        next: show_results
                                                  - else: show_results
                                          - else: show_results
                                  - else: show_results
                          - else: show_results
                  - else: show_results
          - else: show_results

      - action: utter_quiz_results
        id: show_results

  fact_flow:
    description: user asks for a fun fact about history or a specific year
    steps:
      - collect: fact_year
      - action: action_provide_fun_fact
  
  menu:
    description: this flow helps users pick a new topic, time travel, facts or quiz. 
    steps:
      - collect: activity

  time_travel:
    description: The user wants to time travel, this flow helps them visit a time specified by the user.
    steps:
      - collect: era
        description: |
          The historical era the user wants to visit. Map user input as follows:
          - "prehistoric" for dinosaurs, cavemen, stone age, ice age, or ancient pre-civilization times
          - "classical" for ancient Rome, Greece, Egypt, Romans, Greeks, Caesar, gladiators, or ancient civilizations
          - "medieval" for knights, castles, Middle Ages, feudal times, crusades, or medieval period
        next:
          - if: slots.era == "prehistoric"
            then: prehistoric_step
          
          - if: slots.era == "classical"
            then: classical_step
          
          - if: slots.era == "medieval"
            then: medieval_step
          
          - if: slots.era == "renaissance"
            then: renaissance_step
          
          - if: slots.era == "industrial_revolution"
            then: industrial_revolution_step
          
          - if: slots.era == "20th_century"
            then: 20th_century_step

          - if: slots.era == "future"
            then: future_step
          
          - else: don't_understand_step
      
      - id: prehistoric_step
        action: utter_prehistoric_timetravel
        next: back_to_menu
      
      - id: classical_step
        action: utter_classical_timetravel
        next: back_to_menu
      
      - id: medieval_step
        action: utter_medieval_timetravel
        next: back_to_menu

      - id: renaissance_step
        action: utter_renaissance_timetravel
        next: back_to_menu
      
      - id: industrial_revolution_step
        action: utter_industrial_revolution_timetravel
        next: back_to_menu
      
      - id: 20th_century_step
        action: utter_20th_century_timetravel
        next: back_to_menu

      - id: future_step
        action: utter_future_timetravel
        next: back_to_menu

      - id: don't_understand_step
        action: utter_don't_understand
      - link: time_travel

      - id: back_to_menu
        action: utter_back_again
      - link: menu